---
layout: post
subclass: post
title: "입문자를 위한 파이썬 프로그래밍 (4) 함수"
date: 2019-05-17 00:00:04
tags: [python-programming]
excerpt: "파이썬 프로그래밍 입문, 함수에 대한 설명입니다."
disqus: True
---

## 함수

함수 역시 문법보다는 어떻게 사용하면 좋을지와 알아두면 좋은 개념을 이해하고 넘어가는 시간을 가지도록 하겠습니다.

- 함수를 사용하는 이유
- 함수가 동작하는 방식
- 함수의 영역(Scope)
- global 키워드
- 재귀함수
- 모듈
- 실습해보기

## 함수를 사용하는 이유 - 코드의 재사용

같은 기능을 수행하지만 다른 변수에 대해 기능을 적용하고 싶다면 가장 간단하게는 코드를 복사하고 약간 변경해주는 작업을 해줄 수 있을 것입니다. 하지만 이렇게 작업을 하면 기능을 수행하는 블럭에 수정이 필요할 때 모든 코드 블럭을 일일이 찾아서 변경해주어야 하는 문제점이 있습니다.

함수를 사용하면 코드는 재사용하면서 이런 문제를 방지할 수 있습니다. 값을 하드코딩하지 않고 변수에 담아서 재사용했던 것처럼 함수를 사용해 코드의 중복을 최소화합시다.

## 함수를 사용하는 이유 - 추상화와 분해

추상화 : 주어진 문맥에서 필요한 정보만 보존하고 그렇지 않은 정보는 감추는 것

함수를 사용하는 또 다른 이유는 추상화입니다. 본인이든 본인의 팀원이든 함수를 구현하고 나면 함수는 블랙박스처럼 동작하게 됩니다. 내부적으로 구현된 것을 굳이 보지 않더라도 함수의 이름과 입력 그리고 출력을 통해 함수의 동작을 파악하고 구현에 사용할 수 있습니다. 이를 통해 맡은 모듈을 개발하는 데 집중할 수 있습니다.

분해 : 큰 문제를 여러 개의 독립적인 모듈로 세분화해 처리할 수 있습니다.

('Introduction to Computer Science and Programming using Python'이라는 책을 참고해 작성한 내용입니다.)

## 함수가 동작하는 방식

1. 함수가 호출되면 인자에 매개변수 값이 결정됩니다.

```python
def max(a, b):
    # ...

max(10, 2)
```

위의 경우 a에는 10, b에는 2가 바인딩됩니다. (list 자료형의 경우 reference 즉 list 자료의 주소(참조)값이 전달됩니다. 그러므로 실제 값에도 변경이 생길 수 있습니다. 리스트를 학습할 때 조금 더 자세히 살펴보도록 하겠습니다.)

2. 실행지점이 함수가 호출된 지점에서 함수의 본체로 이동합니다.
3. 함수의 본체에 있는 코드가 return 즉 반환문을 만날 때까지 실행됩니다.(그러므로 return문 뒤의 문장은 실행되지 않습니다.) 더 이상 실행할 명령문이 없는데 return을 만나지 못했다면 None을 반환하게 됩니다.
4. 함수 호출의 값은 반환된 값이 됩니다.
5. 실행지점은 함수를 호출했던 곳으로 되돌아가서 그 다음 지점으로 이동하게 됩니다.

## 함수의 영역(Scope)

함수가 호출되면 스택 프레임(stack frame)이 생성됩니다. 스택 프레임은 호출 스택이라고도 하고 콜(Call) 스택이라고 부르기도 합니다. 이 스택 프레임은 형식 매개변수(인자)들을 포함한 함수 내에 정의된 모든 이름들과 바인딩된 값들을 표의 형태로 유지합니다.

만약 해당 함수 내부에서 새로운 함수가 호출된다면 또 다른 스택 프레임이 생성됩니다. 함수 실행이 끝나면 그에 해당하는 스택 프레임도 함께 사라집니다.

다음 링크에 상당히 친절히 설명되어 있어 다음 링크를 참고하면 이해에 큰 도움이 될 것입니다.

[스택 프레임에 대한 설명](https://dojang.io/mod/page/view.php?id=2341)

약간 이해가 힘들 수 있지만 천천히 따라가보면 그 동작을 이해하실 수 있으실 것입니다. 이해가 되신 다음에는 왜 A라는 함수에서 A를 감싸고 있는 함수의 변수를 참조할 수 있는지, 지역변수는 왜 실행이 끝나면 더 이상 참조할 수 없는지 자연스럽게 이해가 되실 것입니다.

파이썬을 lexical scoping이다. 정적 범위, 어휘 범위의 영역(scope)을 가진다고들 설명하고 합니다. 말이 어려울 뿐입니다. 함수가 호출되면 해당 함수의 표(symbol table)이 하나 생기고 끝나면 없어지는 것입니다. 그래서 파이썬에서 변수는 '생성된 함수 내부에서만 유효하다'라고 정리하시면 좋겠습니다.

```python
def f(x):
    def g():
        x = 'abc'
        print('x =', x)
    def h():
        z = x
        print('z =', z)
    x = x + 1
    print('x =', x)
    h()
    g()
    print('x =', x)
    return g

x = 3
z = f(x)
print('x =', x)
print('z =', z)
z()
```

위의 예제도 어떻게 스택 프레임이 생기고 없어질지 한 번 생각해보면 좋겠습니다.

## global 키워드

함수의 영역에 이어서 파이썬 언어가 처음이면 생소할 수 있는 global 키워드를 살펴보고 넘어가겠습니다. 아래처럼 함수 안에서 global에 전역변수 이름을 지정하면 함수 내부에서 전역 변수를 사용할 수 있습니다.

```python
number = 10
def test():
    global number
    number = 20
    print(number)

test()
print(number)
```

```
Output

20
20
```

만약 전역에 없는 변수에 global을 붙이면 전역 변수가 됩니다.

```python
def test():
    global number
    number = 20
    print(number)

test()
print(number)
```

전역 변수는 프로그램의 복잡도를 더하는 것처럼 global 키워드도 남용하면 좋지 않다는 것을 유의하시기 바랍니다.

## 재귀함수

재귀함수는 자기 자신을 호출하는 함수를 말합니다.

```python
def factorial(n):
    if n == 1:
        return n
    else:
        return n * factorial(n-1)
```

위 함수의 else 문을 보면 factorial이라는 함수 자신을 다시 호출한다는 것을 알 수 있습니다.

위 코드를 실행하면 다음과 같이 동작하게 됩니다.

```
factorial(5)
> return 5 * factorial(4)
            > return 4 * factorial(3)
                        > return 3 * factorial(2)
                                    > return 2 * factorial(1)
                                                > return 1
```

위와 같이 실행된 다음 return 1이 되는 순간부터 다시 반환되는 값을 넘겨서 결국 다음과 같은 결과가 됩니다.

```
return 5 * 4 * 3 * 2 * 1 (5!)
```

재귀함수에서는 주의해야 할 점이 있습니다. 반복문에서 무한 루프에 빠질 수 있었던 것처럼 재귀함수 역시 종료가 되지 않는 상황에 빠질 수 있습니다. 그래서 다음과 같은 조건을 유의해서 작성하는 것이 좋습니다.

1. 적어도 하나의 base case 즉 순환되지 않고 종료되는 조건이 있어야 한다.
   (base case는 위의 factorial의 경우 n == 1인 조건을 말합니다. 다시 자기 자신을 호출하지 않는 조건을 말합니다.)
2. 모든 case는 base case로 수렴해야 한다.
   (위 팩토리얼 예제의 경우 n-1을 매개변수로 넘겨줌으로써 n == 1인 조건에 점점 가까워질 수 있었습니다.)

재귀함수를 작성할 때의 팁

```
암시적인(implicit) 매개변수를 명시적인(explicit) 매개변수로 바꾸어라.
```

1. 순차탐색(반복문)

```python
def search(data, target):
    for i in range(len(data)):
        if data[i] == target:
            return i
    return -1
```

위의 경우 data라는 리스트를 전달받아 target 값을 찾으면 해당 인덱스, 그렇지 않으면 -1 을 반환하는 함수입니다.

이를 재귀함수로 작성한다면 탐색공간의 시작과 끝인 0, len(data) 은 매개변수로 명시적으로 드러나도록 하는 것이 좋습니다. 다음 코드를 살펴보도록 하겠습니다.

2. 순차탐색(재귀함수)

```python
def search(data, begin, end, target):
    if begin > end:
        return -1
    elif data[begin] == target:
        return begin
    else:
        return search(data, begin+1, end, target)
```

탐색공간의 시작과 끝을 begin, end 이라는 명시적인 매개변수로 나타냈습니다. 이렇게 매개변수를 잘 정하고 시작하면 재귀함수의 설계가 조금 더 쉽게 느껴질 것입니다.

(재귀함수의 설계에 대한 내용은 부경대 권오흠 교수님의 '영리한 프로그래밍을 위한 알고리즘 강좌'의 내용을 참고해 작성했습니다.)

## 모듈

모듈은 변수와 함수 그리고 아직은 배우지 않은 클래스 등이 정의된 하나의 파일을 말합니다. 모든 프로그램을 하나의 파일에 작성하는 것은 프로그램이 작으면 크게 상관이 없겠지만 커지면 무리입니다. 그래서 프로그램을 여러 파일에 나누어 저장하고 하나의 파일에서 다른 파일의 내용을 불러와서 사용할 수 있도록 합니다. 이 때 하나의 파일을 모듈이라고 합니다.

```python
# circle.py
pi = 3.14159

def area(radius):
    return pi * (radius ** 2)
```

위와 같은 파일이 있을 때 아래의 파일에서 불러와 해당하는 코드를 사용할 수 있는 것입니다.

```python
# test.py
import circle

print(circle.pi)
print(circle.area(3))
```

```
Output

3.14159
28.27431
```

circle 모듈(파일)의 pi 변수와 area 함수를 사용한 것입니다.

```python
from circle import area
```

위와 같이 불러오는 방법도 가능합니다.

```python
from circle import *
```

또 위와 같이 import 즉 불러오는 것도 가능합니다. 하지만 PEP 8 파이썬 스타일 가이드에서도, 파이썬 프로그래밍 입문 책들에서도 이런 방법은 피하라고 말합니다. 이유는 어떤 모듈에서 어떤 메소드들을 불러오는 것인지 파악하기 힘들기 때문입니다. 그래서 되도록 삼가하는 것이 좋겠습니다.

## 실습해보기

- 피보나치 수 구하기

재귀 개념을 익혔으니 피보나치 수를 구하는 문제를 통해 개념을 확인해봅시다.

[피보나치수](https://www.acmicpc.net/problem/2747)

- 팰린드롬 구하기

약간 어려울 수도 있지만 재귀 개념을 이해하는데 큰 도움이 될 것이라고 생각해 넣었습니다.
재귀 개념이 엄청 많이 사용되기보다는 큰 문제를 작은 문제로 나누어 해결하는 개념에 익숙해지는데 큰 도움이 될 것이라고 생각해서 넣어봤습니다.

[가장 긴 팰린드롬](https://programmers.co.kr/learn/courses/30/lessons/12904)

- N-Queen(선택)

유명한 N-Queen 문제입니다. 이전까지 배운 조건문 등과 재귀 개념을 활용해서 한 번 도전해보면 좋을 것 같습니다. 프로그래밍을 접한지 얼마되지 않은 분에게는 엄청나게 어려운 문제일 것입니다. 풀면 엄청 대단한 거고, 풀지 못해도 나중에 풀면 되니 도전에 의의를 두고 접해보면 좋겠습니다. (팰린드롬이 어려우시면 아예 풀지 않으셔도 좋습니다.)

[N-Queen](https://programmers.co.kr/learn/courses/30/lessons/12952)
