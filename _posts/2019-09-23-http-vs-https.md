---
layout: post
subclass: post
title: "HTTP와 HTTPS의 차이"
date: 2019-09-23
tags: [programming, web, https, ssl]
excerpt: "HTTPS와 HTTP의 차이에 대한 설명입니다."
disqus: True
---

사내 golang 스터디 중 우연히(?) 팀장님께서 HTTP와 HTTPS의 차이점에 대해 물으셨습니다.

```
팀장님: HTTP와 HTTPS의 차이점이 뭐죠?
나: HTTPS는 보안이 들어가있지 않나요?..음 SSL..
```

HTTP와 HTTPS의 차이에 대해 제대로 답하지 못해 반성의 의미에서 정리해봅니다.

# HTTP란?

HTTP는 HyperText Transfer Protocol의 약자로 인터넷 상에서 HTML 문서와 같은 웹 리소스(Resource)를
주고 받기 위한 통신규칙(프로토콜)입니다. 간단히 말하면 브라우저 주소창에 www.naver.com와 같은 웹 사이트 주소를
입력해 웹 페이지를 응답으로 받을 때 사용하는, 웹 브라우저와 웹 서버간의 통신 규칙입니다.

# HTTPS란?

하지만 최근에 사용되는 프로토콜은 대부분 HTTP가 아닌 HTTPS입니다. (https://www.naver.com와 같은 웹 사이트 주소를 보면
프로토콜을 의미하는 시작부분이 http:// 대신 https://로 시작하는 것을 볼 수 있습니다.) HTTPS는 HyperText Transfer
Protocol over Secure Socket Layer의 약자로, HTTP의 보안이 강화된 버전입니다.

차이는 마지막에 붙는 'over Secure Socket Layer'입니다. 여기서 Secure Socket Layer은 줄여서 SSL이라고 합니다.
간단히 SSL이 무엇인지 알아보고 HTTPS가 어떻게 동작하는지 살펴보겠습니다.

# SSL(Secure Socket Layer)이란?

SSL은 웹 브라우저와 웹 서버간의 통신에서 암호화 기법 등의 보안 메커니즘을 제공하여 안전하게 통신할 수 있도록 하는 프로토콜입니다.
간단히 말하면 웹 서버와 웹 브라우저간의 통신에서 전송되는 내용을 암호화하여 제3자가 악의적으로 훔쳐보거나 위조하는 것을 막는 프로토콜(통신규칙)
입니다. 예를 들면 인터넷 쇼핑몰 사이트에서 신용카드를 사용해서 결제할 때 신용카드 정보와 같은 민감 정보를 암호화된 형태로 전송하여 제3자가 악의적으로
보고 악용하는 것을 막을 수 있습니다.

# SSL를 이해하기 위해 알아야 하는 것들 - 대칭키 암호화 방식 / 공개키 암호화 방식

SSL의 보안 메커니즘을 이해하기 위해서는 2가지 암호화 방식에 대한 이해가 필요합니다.

1. 대칭키 암호화 방식

A 컴퓨터에서 B 컴퓨터로 'LOVE'라는 민감한 정보를 전달한다고 가정해보겠습니다. 이 때 LOVE라는 내용을 누구나 쉽게 읽을 수 있는 평문(plain text)라고 하고,
민감한 정보이므로 누구나 쉽게 읽을 수 없도록 암호화하여 전달되어야 한다고 생각해보겠습니다.

이 때 사용될 수 있는 방법 중 하나가 대칭 키 암호화방식입니다. 대칭 키 암호화방식은 송신자와 수신자가 같은 키를 보유하고 그 키를 통해 송신자가 평문을 암호화하여 전송하면
수신자가 같은 키로 복호화하는 것을 말합니다. 예를 들어 'LOVE'라는 평문을 각 알파벳을 다음 알파벳으로 바꾸어 'MPZF'라는 암호화된 텍스트로 변경하여 전달하면, 수신자는
'다음 알파벳으로 변경되었다는 사실'을 바탕으로 이전 알파벳으로 다시 변경해 복호화합니다.(암호화된 것을 이전 상태로 되돌리는 것을 복호화라고 합니다.)

이 때 암호화, 복호화를 할 때 기준이 되는 데이터를 키라고 합니다. 대칭키 암호화 방식은 송신자와 수신자가 암호화, 복호화의 기준이 되는 키를 동일하게 보유하고 있어야 하는 방식
입니다.

대신 이 대칭키 암호화 방식의 문제점은 복호화하는 쪽에서 복호화하기 위한 키를 전송받아야 한다는 것입니다. 이 때 복호화하기 위한 키 값은 암호화되지 않은 값이기 때문에 제3자에게
노출될 수 있다는 문제점이 있습니다.

2. 공개키 암호화 방식

공개키 암호화 방식은 위 대칭키 암호화 방식의 문제점을 해결하기 위해 나온 방식입니다. 공캐키 암호화 방식은 대칭키 암호화 방식과 다르게 키가 2개가 있고 A키로 암호화하면 B키로
복호화할 수 있고, B키로 암호화하면 A키로 복호화할 수 있는 방식을 말합니다. 이 때 키 중 하나를 private key(비공개키) 그리고 다른 하나를 public key(공개키)라고 합니다.
말그대로 공개키는 누구에게나 공개되어도 되는 키이며, 비공개키는 공개하지 않고 특정 사람이나 기관에서 보유하게 됩니다. 정리하면 공개키로 암호화한 평문은 비공개키로 복호화할 수 있고,
비공개키로 암호화한 평문은 공개키로 복호화할 수 있습니다.

공개키는 누구나 취득할 수 있지만 비공개키는 특정 개인 또는 기관에서 보유하기 때문에 공개키로 암호화한 내용을 누구나 복호화하는 것은 불가능합니다. 또한, 키가 2개 존재하기 때문에
키를 전송해야 하는 문제점이 사라집니다.

이 공개키 암호화 방식을 응용하여 아래의 절차를 수행하면 2가지 목표를 달성할 수 있습니다.

```
1. 비공개키의 소유자가 비공개키를 이용하여 정보를 암호화한 후 공개키와 함께 암호화된 정보를 상대방에게 전송한다.
2. 정보와 공개키를 획득한 상대방은 공개키를 이용하여 암호화된 정보를 복호화한다.
```

이 때 공개키가 유출된다면 데이터가 복호화될 위험이 있습니다. 하지만 중요한 것은 데이터를 보호하는 것이 아닙니다. 암호화된 데이터를
공개키를 가지고 복호화할 수 있었다는 것은 비공개키를 통해 암호화되었다는 것을 의미합니다. 이는 전송한 측이 비공개키를 보유하고 있다는 것을
말해줍니다.

이 과정에서 달성할 수 있는 2가지 목적은 아래와 같습니다.

```
1. 공개키를 제공한 측이 비공개키를 보유하고 있는 상대방이라는 것을 보장해준다.
2. 공개키를 제공해 이후의 데이터 전송은 암호화하여 비공개키를 보유한 상대방에게 전달할 수 있다.
```

# SSL 인증서

SSL을 활용한 통신을 이해하기 위해 또 하나 필요한 것이 SSL 인증서입니다. SSL을 활용해 통신할 때 SSL 인증서라고 불리는 '클라이언트와 서버간의
통신을 제3자가 보증해준 전자문서'를 활용합니다. 이를 활용해 아래의 이점을 얻을 수 있습니다.

- 클라이언트가 접속한 서버가 신뢰할 수 있는 서버인지 판단할 수 있다.
- 통신 내용이 제3자의 악의적인 공격에 의해 노출되는 것을 막을 수 있다.

여기서 SSL 인증서를 발급해주는 제3자가 CA(Certificate Authority)라고 불리는 민간기업들입니다. SSL 통신을 통해 웹 사이트 방문 고객들로부터
신뢰를 얻고 싶은 서비스들은 이 CA로부터 인증서를 발급받아야 합니다.

실제로 Chrome 브라우저에서 url 주소 입력창에 있는 자물쇠 버튼을 클릭한 다음 '인증서 > 세부사항'을 이어서 클릭하면 어떤 기업에서
인증하고 있는지 알 수 있습니다. 당연히 https 통신을 하고 있는 서비스이어야 합니다. https 통신이 아닌 http 통신이라면 자물쇠 버튼 대신 '주의 요함'
문구가 있을 것입니다.

세부사항을 확인해보면 아래의 내용이 포함되어 있다는 것을 알 수 있습니다.

```
1. 서비스의 정보(인증서를 발급한 CA, 서비스 도메인 정보 등)
2. 서비 측 공개키 정보(공개 키의 내용, 공개키의 암호화 방식)
```

# SSL 인증서의 보증 방법

앞서 말했듯 SSL 인증서는 클라이언트가 접속한 서버가 신뢰할 수 있는 서버라는 것을 보증합니다. 그 방식은 다음과 같습니다.

```
1. 웹 브라우저로 서버에 접속한다.
2. 이 때 서버가 제일 먼저 인증서를 제공한다.
3. 웹 브라우저는 이 인증서를 발급한 CA가 웹 브라우저가 내부적으로 미리 파악한 리스트에 있는지 확인한다.
4. 포함되어 있다면, 해당 CA의 공개키를 이용해서 인증서를 복호화한다. 복호화에 성공하면 인증이 된 것이다.
(복호화가 가능하다는 것은 CA의 비공개키로 암호화한, CA가 발급한 인증서가 맞다는 의미가 된다.)
```

# SSL 통신과정

마지막으로 SSL 통신과정을 정리해보겠습니다. SSL의 통신과정은 앞서 살펴본 암호화 방식 중 대칭키와 공개키 암호화 방식을 혼합해 사용합니다.
이유는 공개키 암호화 방식이 키를 전달할 필요가 없는 이상적인 방법이지만 그만큼 컴퓨팅 자원이 더욱 요구되기 때문입니다. 그러므로 실제
데이터는 대칭키 암호화 방식을, 대칭키의 키는 공개키 암호화 방식을 사용합니다.

통신과정은 다음과 같습니다.

```
SSL Handshake(초기 연결 수립 단계)

1) 클라이언트가 서버에 접속(클라이언트에서 SSL 버전 정보, 클라이언트에서 지원하는 암호화 방식, 생성한 랜덤 데이터를 전달)
2) 서버에서 클라이언트에 응답(클라언트 지원 암호화 방식 중 서버가 선택한 암호화 방식, 서버가 생성한 랜덤 데이터, 인증서, 연결을 식별할 세션 ID 전달)
3) 클라이언트에서 서버가 전달한 인증서가 CA에 의해 발급된 것인지 복호화를 통해 확인 / 이 과정을 통해 서버의 공개키를 획득
4) 클라이언트에서 클라이언트에서 생성한 데이터와 서버에서 생성한 데이터를 조합하여 pre master secret 키를 생성(pre master secret 키를 활용하여 이후
통신에서 대칭키 암호화 방식의 통신을 하므로 절대로 노출되어서는 안된다.) / 3번 과정에서 획득한 서버의 공개키를 통해 pre master secret 키를 암호화하여 서버에 전달
5) 서버에서 클라이언트에서 전송한 pre master secret 값을 자신의 비공개키로 복호화 / 공유한 pre master secret 값을 바탕으로 master secret 값을
만들고 이를 바탕으로 session key를 생성(session key를 활용하여 서버와 클라이언트는 대칭키 방식으로 통신)
6) Handshake의 종료를 서로 알림

Session(데이터 주고 받는 단계)

7) 서버가 Session key를 바탕으로 데이터를 암호화하여 통신

Session 종료(연결 해제)

8) SSL 통신이 끝났음을 알리고, 대칭 키인 Session key를 폐기
```

SSL 인증서를 포함한 SSL의 동작방식을 살펴봤습니다. 인증서를 구입하고 어떻게 서버에서 사용하는가에 대한 내용은 다른 글로 정리하도록 하겠습니다. 아래의 링크를 참고하여
작성했습니다. 생활코딩의 'HTTPS와 SSL인증서' 글이 크게 도움이 되었습니다. 실제 방문하셔서 영상을 참고해보시는 것을 추천드립니다. 감사합니다.

참고링크)

HTTPS와 SSL 인증서 - 생활코딩
https://opentutorials.org/course/228/4894

HTTP vs HTTPS: The Difference And Everything You Need To Know
https://seopressor.com/blog/http-vs-https/

Why is HTTP not secure? | HTTP vs. HTTPS
https://www.cloudflare.com/learning/ssl/why-is-http-not-secure/

HTTP Vs HTTPS: An In-Depth Comparison Of Features And Performance
https://www.softwaretestinghelp.com/http-vs-https/
